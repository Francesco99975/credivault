<h1 class="center" mat-dialog-title>Set Master Password</h1>

<mat-dialog-content>
  <div class="container">
    <div class="row">
      <form [formGroup]="form" (ngSubmit)="onSubmit()" class="col s12">
        <div class="row" *ngIf="previous">
          <div class="col s12">
            <label for="prev">Enter Current Password</label>
            <input type="text" name="prev" id="prev" formControlName="prev" />
          </div>
        </div>
        <div class="row">
          <div class="col s7">
            <label for="master">Enter Master Password</label>
            <input
              type="text"
              name="master"
              id="master"
              formControlName="master"
              [value]="form.value.master"
            />
          </div>
          <div class="col s5">
            <div *ngIf="loading" class="preloader-wrapper active">
              <div class="spinner-layer spinner-red-only">
                <div class="circle-clipper left">
                  <div class="circle"></div>
                </div>
                <div class="gap-patch">
                  <div class="circle"></div>
                </div>
                <div class="circle-clipper right">
                  <div class="circle"></div>
                </div>
              </div>
            </div>
            <a
              *ngIf="!loading"
              class="btn teal darken-3 white-text"
              (click)="generateRandomPassword()"
            >
              <i class="material-icons white-text left waves-effect waves-light"
                >lock</i
              >
              <span>Generate</span>
            </a>
          </div>
        </div>
        <div class="row">
          <div class="row col s12 center-align">
            <button
              type="submit"
              class="btn teal darken-3 white-text waves-effect waves-light"
              [disabled]="form.invalid || loading"
            >
              Set Master Password
            </button>
          </div>
        </div>
        <div class="progress" *ngIf="loading && form.valid">
          <div class="indeterminate"></div>
        </div>
        <div class="row" *ngIf="encryptedMaster && !loading">
          <div class="col s7 center-align">
            <input
              type="text"
              name="encryptedd"
              id="encryptedd"
              class="flow-text truncate"
              [value]="encryptedMaster"
            />
          </div>
          <div class="col s5 center-align">
            <a
              class="btn teal darken-3 waves-effect waves-light"
              [copy-clipboard]="encryptedMaster"
              (copied)="onCopy($event)"
            >
              <span>Copy</span>
              <i class="material-icons left">assignment</i>
            </a>
          </div>
        </div>
      </form>
    </div>
  </div>
</mat-dialog-content>

<mat-dialog-actions>
  <div class="container">
    <div class="row">
      <div class="col s6 right-align">
        <button
          class="btn red white-text waves-effect waves-light"
          (click)="onReset()"
        >
          Reset Master Password
        </button>
      </div>
      <div class="col s6 right-align">
        <button
          class="btn red white-text waves-effect waves-light"
          (click)="close()"
        >
          Close
        </button>
      </div>
    </div>
  </div>
</mat-dialog-actions>
